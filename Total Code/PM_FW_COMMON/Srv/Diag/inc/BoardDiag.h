/*
***********************************************************************************************************************
*                  Copyright(c) 北京康吉森技术有限公司 2015
*           Beijing Consen Technologies Co.,Ltd. All rights reserved.
*
*
*  项目名称    : 安全控制系统
*
*  模块名称    :
*
*  文件名称    : BoardDiag.h
*
*  功能简介    :
*
*  作者            : 李琦
*
*  创建日期    : 2016-11-23
*
*  版本信息    : V1.0
*
*  修订信息    : 无
*
***********************************************************************************************************************
*/
#ifndef _BOARD_DIAG_H
#define _BOARD_DIAG_H

/*
***********************************************************************************************************************
*                                包含头文件
***********************************************************************************************************************
*/
#include "CPUTest.h"
#include "CodeTest.h"
#include "RamTest.h"
//#include "ExcptTest.h"
#include "DiagCommon.h"

/*
***********************************************************************************************************************
*                                宏定义
***********************************************************************************************************************
*/


/*
***********************************************************************************************************************
*                                数据结构定义
***********************************************************************************************************************
*/

/*
***********************************************************************************************************************
*                                全局函数声明
***********************************************************************************************************************
*/

/*
***********************************************************************************************************************
* 函数名称: Core1DiagInit
*
* 功能描述: 板级自检初始化
*
* 输入参数: 无
*
* 输出参数: 无
*
* 返 回 值  : 无
*
* 注意事项: 无
***********************************************************************************************************************
*/
void Core1DiagInit(void);
/*
***********************************************************************************************************************
* 函数名称: Core1DiagPowerOn
*
* 功能描述: 上电自检，只在初始化时调用一次。
*
* 输入参数: 无
*
* 输出参数: 无
*
* 返 回 值  : 无
*
* 注意事项: 无
***********************************************************************************************************************
*/
void Core1DiagPowerOn(void);
/*
***********************************************************************************************************************
* 函数名称: Core1DiagCycle
*
* 功能描述: 周期自检调度函数。
*
* 输入参数: 无
*
* 输出参数: 无
*
* 返 回 值  : 无
*
* 注意事项: 无
***********************************************************************************************************************
*/
void Core1DiagCycle(void);
/*
***********************************************************************************************************************
* 函数名称: BoardDiagMngt
*
* 功能描述: 依次调用各子自检函数
*
* 输入参数: 无
*
* 输出参数: 无
*
* 返 回 值  : 无
*
* 注意事项: 无
***********************************************************************************************************************
*/
void BoardDiagMngt(void);
/*
***********************************************************************************************************************
* 函数名称: BoardDiagCycleEnable
*
* 功能描述: 设置周期性诊断使能各标志位设置。
*
* 输入参数: uiflag:  为TRUE时使能周期诊断，否则不使能。
*
* 输出参数: 无
*
* 返 回 值  : 无
*
* 注意事项: 无
***********************************************************************************************************************
*/
uint32_t BoardDiagCycleEnable(uint32_t uiflag);
/*
***********************************************************************************************************************
* 函数名称: BoardDiagGetDiagDone
*
* 功能描述: 获取诊断完成标志。
*
* 输入参数: uiflag:  为TRUE时使能周期诊断，否则不使能。
*
* 输出参数: 无
*
* 返 回 值  : 诊断完成标志
*
* 注意事项: 无
***********************************************************************************************************************
*/
uint32_t BoardDiagGetDiagDone(void);
/*
***********************************************************************************************************************
* 函数名称: BoardDiagSetDiagDone
*
* 功能描述: 设置诊断完成标志。
*
* 输入参数: 无
*
* 输出参数: 无
*
* 返 回 值  : 无
*
* 注意事项: 无
***********************************************************************************************************************
*/
void BoardDiagSetDiagDone(void);
/*
***********************************************************************************************************************
* 函数名称: BoardDiagClrDiagDone
*
* 功能描述: 清除诊断完成标志。
*
* 输入参数: 无
*
* 输出参数: 无
*
* 返 回 值  : 无
*
* 注意事项: 无
***********************************************************************************************************************
*/
void BoardDiagClrDiagDone(void);
/*
***********************************************************************************************************************
* 函数名称: BoardDiagGetDiagEnable
*
* 功能描述: 获取诊断使能标志。
*
* 输入参数: 无
*
* 输出参数: 无
*
* 返 回 值  : 诊断完成标志
*
* 注意事项: 无
***********************************************************************************************************************
*/
uint32_t BoardDiagGetDiagEnable(void);
/*
***********************************************************************************************************************
* 函数名称: BoardDiagSetDiagEnable
*
* 功能描述: 设置诊断使能标志。
*
* 输入参数: 无
*
* 输出参数: 无
*
* 返 回 值  : 无
*
* 注意事项: 无
***********************************************************************************************************************
*/
void BoardDiagSetDiagEnable(void);
/*
***********************************************************************************************************************
* 函数名称: BoardDiagClrDiagEnable
*
* 功能描述: 清除诊断使能标志。
*
* 输入参数: 无
*
* 输出参数: 无
*
* 返 回 值  : 无
*
* 注意事项: 无
***********************************************************************************************************************
*/
void BoardDiagClrDiagEnable(void);
/*
***********************************************************************************************************************
* 函数名称: BoardDiagGetRelocateDone
*
* 功能描述: 获取重定位完成标志。
*
* 输入参数: 无
*
* 输出参数: 无
*
* 返 回 值  : 完成标志
*
* 注意事项: 无
***********************************************************************************************************************
*/
uint32_t BoardDiagGetRelocateDone(void);
/*
***********************************************************************************************************************
* 函数名称: BoardDiagSetRelocateDone
*
* 功能描述: 设置重定位完成标志。
*
* 输入参数: 无
*
* 输出参数: 无
*
* 返 回 值  : 无
*
* 注意事项: 无
***********************************************************************************************************************
*/
void BoardDiagSetRelocateDone(void);
/*
***********************************************************************************************************************
* 函数名称: BoardDiagClrRelocateDone
*
* 功能描述: 清除重定位完成标志。
*
* 输入参数: 无
*
* 输出参数: 无
*
* 返 回 值  : 无
*
* 注意事项: 无
***********************************************************************************************************************
*/
void BoardDiagClrRelocateDone(void);
/*
***********************************************************************************************************************
* 函数名称: BoardDiagRelocateStart
*
* 功能描述: 当自检完成时，执行重定位操作，转向诊断完成区域执行代码。
*
* 输入参数:
*       pstThis:     诊断控制信息
*      puiLrValue:  lr 寄存器值
*      uiStackPos:  当前堆栈指针
*
* 输出参数: 无
*
* 返 回 值  : 无
*
* 注意事项: 无
***********************************************************************************************************************
*/
void BoardDiagRelocateStart(DiagCtrlInfo_t* pstThis,uint32_t puiLrValue,uint32_t uiStackPos);
/*
***********************************************************************************************************************
* 函数名称: BoardDiagJumpEntry
*
* 功能描述: 重定位入口函数。
*
* 输入参数: pstThis      诊断控制信息
*
* 输出参数: 无
*
* 返 回 值  : 跳转检查结果
*
* 注意事项: 无
***********************************************************************************************************************
*/
uint32_t BoardDiagJumpEntry(DiagCtrlInfo_t* pstThis);
/*
***********************************************************************************************************************
* 函数名称: RelocateStackPointer
*
* 功能描述: 设置栈顶地址
*
* 输入参数: uiStackPos   新栈顶地址
*
* 输出参数: 无
*
* 返 回 值  : 无
*
* 注意事项: 无
***********************************************************************************************************************
*/
void RelocateStackPointer(uint32_t uiStackPos);
/*
***********************************************************************************************************************
* 函数名称: BoardDiagCopyProgramData
*
* 功能描述: 复制用户工程数据至新执行区域。
*
* 输入参数: uiSrcAddr:     源地址
*        iSize 拷贝数据长度
*
* 输出参数: 无
*
* 返 回 值  : 无
*
* 注意事项: 无
***********************************************************************************************************************
*/
void BoardDiagCopyProgramData(uint32_t uiSrcAddr, int32_t iSize);
/*
***********************************************************************************************************************
* 函数名称: BoardDiagCallIecProgram
*
* 功能描述: 调用IEC工程并保护其环境。
*
* 输入参数: puiFunc:     调用函数。
*
* 输出参数: 无
*
* 返 回 值  : 函数执行标志，TRUE为成功执行，FALSE为失败。
*
* 注意事项: 无
***********************************************************************************************************************
*/
uint32_t BoardDiagCallIecProgram(puint32_t puiFunc);
/*
***********************************************************************************************************************
* 函数名称: BoardDiagCalcuMaxTime
*
* 功能描述: 统计目前输入时间中最大数值。
*
* 输入参数: uiCurTimeus:   输入用于与历史数据比较的时间间隔。
*
* 输出参数: 无
*
* 返 回 值  : 当前最大时间间隔
*
* 注意事项: 无
***********************************************************************************************************************
*/
uint32_t BoardDiagCalcuMaxTime(const uint32_t uiCurTimeus);
/*
***********************************************************************************************************************
* 函数名称: PrintCompareDataArray
*
* 功能描述: 逐个比较两数据区数据
*
* 输入参数:
*      pucMsgStr:   文本头
*      puiSrcValue: 源数据地址指针
*      puiDstValue: 目的数据地址指针
*      uiCount:     比较数据字节数
*      ucFlag:      打印十进制或是十六进制
*
* 输出参数: 无
*
* 返 回 值  : 当前最大时间间隔
*
* 注意事项: 无
***********************************************************************************************************************
*/
void PrintCompareDataArray(puint8_t pucMsgStr, puint32_t puiSrcValue, puint32_t puiDstValue,uint32_t uiCount,uint8_t ucFlag);

#endif/*end of _BOARD_DIAG_H*/

/*
***********************************************************************************************************************
                                 文件结束
***********************************************************************************************************************
*/


